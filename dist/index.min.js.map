{"version":3,"file":"index.min.js","sources":["../../src/sticky/AutoSticky.tsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\n\nexport enum ScrollType {\n  UP,\n  DOWN,\n}\n\nconst AutoSticky = () => {\n  const ref = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    let lastOffsetTop = 0;\n    let type = ScrollType.UP;\n    const options = {\n      offsetTop: 100,\n      offsetBottom: 0,\n    };\n\n    const target = ref.current;\n    const body = window.document.querySelector(\"body\");\n    const block = document.createElement(\"div\");\n    target?.before(block);\n\n    function setBlockHeight(height: number) {\n      block.style.height = `${height}px`;\n    }\n\n    function onScrollDown(el: HTMLElement) {\n      if (!target || lastOffsetTop >= el.scrollTop) return;\n      const { top } = block.getBoundingClientRect();\n      if (top > 0) setBlockHeight(0);\n      else if (top + target.scrollHeight >= el.clientHeight) {\n        setBlockHeight(\n          Math.abs(block.getBoundingClientRect().top) + options.offsetTop\n        );\n      }\n      target.style.top = `${el.clientHeight - target.scrollHeight}px`;\n      target.style.bottom = \"\";\n      type = ScrollType.DOWN;\n    }\n\n    function onScrollUp(el: HTMLElement) {\n      if (!target || lastOffsetTop <= el.scrollTop) return;\n\n      setBlockHeight(target.offsetTop);\n      target.style.bottom =\n        el.clientHeight - target.scrollHeight - options.offsetTop + \"px\";\n      target.style.top = \"\";\n      type = ScrollType.UP;\n    }\n\n    function handleScroll(this: HTMLElement) {\n      if (!target) return;\n      if (target.scrollHeight <= this.clientHeight) {\n        body?.removeEventListener(\"scroll\", handleScroll);\n        return (target.style.top = options.offsetTop + \"px\");\n      }\n\n      switch (type) {\n        case ScrollType.UP:\n          onScrollDown(this);\n          break;\n        case ScrollType.DOWN:\n          onScrollUp(this);\n          break;\n        default:\n          break;\n      }\n      lastOffsetTop = this.scrollTop;\n    }\n    body?.addEventListener(\"scroll\", handleScroll, false);\n    if (target && body) onScrollDown(body);\n\n    return () => {\n      body?.removeEventListener(\"scroll\", handleScroll);\n      block.remove();\n    };\n  }, []);\n  useEffect(() => {\n    const target = ref.current;\n    if (target) {\n      const block = document.createElement(\"div\");\n      target.before(block);\n      return () => {\n        block.remove();\n      };\n    }\n  }, []);\n  return { ref };\n};\n\nexport default AutoSticky;\n"],"names":["ScrollType","AutoSticky","ref","useRef","useEffect","lastOffsetTop","type","UP","options","target","current","body","window","document","querySelector","block","createElement","setBlockHeight","height","style","onScrollDown","el","scrollTop","top","getBoundingClientRect","scrollHeight","clientHeight","Math","abs","bottom","DOWN","handleScroll","this","removeEventListener","offsetTop","before","addEventListener","remove"],"mappings":"kDAEYA,GAAZ,SAAYA,GACVA,EAAAA,EAAA,GAAA,GAAA,KACAA,EAAAA,EAAA,KAAA,GAAA,OAFF,CAAYA,IAAAA,EAGX,KAEK,MAAAC,EAAa,KACjB,MAAMC,EAAMC,EAAuB,MA+EnC,OA9EAC,GAAU,KACR,IAAIC,EAAgB,EAChBC,EAAON,EAAWO,GACtB,MAAMC,EACO,IAIPC,EAASP,EAAIQ,QACbC,EAAOC,OAAOC,SAASC,cAAc,QACrCC,EAAQF,SAASG,cAAc,OAGrC,SAASC,EAAeC,GACtBH,EAAMI,MAAMD,OAAS,GAAGA,MAG1B,SAASE,EAAaC,GACpB,IAAKZ,GAAUJ,GAAiBgB,EAAGC,UAAW,OAC9C,MAAMC,IAAEA,GAAQR,EAAMS,wBAClBD,EAAM,EAAGN,EAAe,GACnBM,EAAMd,EAAOgB,cAAgBJ,EAAGK,cACvCT,EACEU,KAAKC,IAAIb,EAAMS,wBAAwBD,KAAOf,GAGlDC,EAAOU,MAAMI,IAASF,EAAGK,aAAejB,EAAOgB,aAA5B,KACnBhB,EAAOU,MAAMU,OAAS,GACtBvB,EAAON,EAAW8B,KAapB,SAASC,IACP,GAAKtB,EAAL,CACA,GAAIA,EAAOgB,cAAgBO,KAAKN,aAE9B,OADAf,GAAMsB,oBAAoB,SAAUF,GAC5BtB,EAAOU,MAAMI,IAAMf,EAAoB,KAGjD,OAAQF,GACN,KAAKN,EAAWO,GACda,EAAaY,MACb,MACF,KAAKhC,EAAW8B,KArBAT,EAsBHW,MArBVvB,GAAUJ,GAAiBgB,EAAGC,YAEnCL,EAAeR,EAAOyB,WACtBzB,EAAOU,MAAMU,OACXR,EAAGK,aAAejB,EAAOgB,aAAejB,EAAoB,KAC9DC,EAAOU,MAAMI,IAAM,GACnBjB,EAAON,EAAWO,IAPpB,IAAoBc,EA2BlBhB,EAAgB2B,KAAKV,WAKvB,OApDAb,GAAQ0B,OAAOpB,GAiDfJ,GAAMyB,iBAAiB,SAAUL,GAAc,GAC3CtB,GAAUE,GAAMS,EAAaT,GAE1B,KACLA,GAAMsB,oBAAoB,SAAUF,GACpChB,EAAMsB,YAEP,IACHjC,GAAU,KACR,MAAMK,EAASP,EAAIQ,QACnB,GAAID,EAAQ,CACV,MAAMM,EAAQF,SAASG,cAAc,OAErC,OADAP,EAAO0B,OAAOpB,GACP,KACLA,EAAMsB,aAGT,IACI,CAAEnC"}